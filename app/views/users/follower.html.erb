<div class="d-none d-lg-flex flex-wrap" style="margin: 0 -10px; box-sizing: border-box; padding: 0;">


  <div style="width: 25%; padding-left: 10px; padding-right: 10px;position: relative; padding-top: 30px;"><!-- 카드파트 -->
    <div style="position: sticky; top: 160px; transition: top 0.1s;"><!-- 카드내부파트 -->
      <div style="position: relative;">
        <div>
          <div style= "padding: 30px 25px 18px;
                border-radius: 4px;
                border: 1px solid rgb(218, 220, 224);
                box-shadow: rgba(63, 71, 77, 0.06); position: relative;">

            <div style=" padding: 0px;min-height: 120px;     position: relative; margin: 0px 0px 20px"><!-- プロフィール～設定 -->
                <div style="width: 120px; height: 120px; position: relative; margin: 0px auto 24px; top: 0px; left: 0px; border-radius: 100%; background-color: rgb(237, 237, 237); overflow: hidden;">
                  <%= image_tag url_for(@userinfo.get_profile_image), alt: "プロフィール画像", class: "rounded-circle", style: "width: 120px; height: 120px; object-fit: cover; border: 1px solid rgba(0, 0, 0, 0.1);" %>
                </div>

                <div style="text-align: center;"><!-- その他 -->
                  <div style="line-height: 1.15;         margin: 0px 0px 10px;
                                font-size: 22px; font-weight: bold;     color: rgb(41, 41, 41);
                            overflow-wrap: break-word;
                            word-break: break-all;
                        }">
                    <%= @userinfo.nickname %>
                  </div>
  
                  <div style="text-align: center;">
                    <div class="d-flex justify-content-center align-items-center mb-3 flex-nowrap text-nowrap text-secondary" style="font-size:12px; line-height:1.4;">
                      <div class="me-3" style="margin-right:5px;">
                        <span class="me-1" style="margin-right: 3px">フォロワー</span>
                        <%= link_to @userinfo.followers.count, follower_user_path(@userinfo),
                                    class: "fw-bold text-dark text-decoration-none" %>
                      </div>
                      <div style="padding-left: 5px; border-left: 1px solid black">
                        <span class="me-1" style="margin-right: 3px">フォロー中</span>
                        <%= link_to @userinfo.following.count, followee_user_path(@userinfo),
                                    class: "fw-bold text-dark text-decoration-none" %>
                      </div>
                    </div>



                    <% if current_user == @userinfo%>
                      <div><!-- 設定ボタン -->
                        <%= link_to "設定", edit_user_path(current_user), class: "btn",
                        style: "margin: 0px;
                                background: none;
                                font-style: inherit;
                                font-variant: inherit;
                                font-stretch: inherit;
                                font-family: inherit;
                                font-optical-sizing: inherit;
                                font-size-adjust: inherit;
                                font-kerning: inherit;
                                font-feature-settings: inherit;
                                font-variation-settings: inherit;
                                font-size: 12px;
                                line-height: 18px;
                                display: inline-flex;
                                -webkit-box-pack: center;
                                justify-content: center;
                                -webkit-box-align: center;
                                align-items: center;
                                height: 33px;
                                border-radius: 4px;
                                padding: 0px 16px;
                                font-weight: 400;
                                box-sizing: border-box;
                                text-align: center;
                                color: rgb(47, 52, 56);
                                border: 1px solid rgb(230, 230, 230);
                                width: 56px;"%>
                      </div>
                    <% else %>
                      <div class="ms-auto">
                        <% if user_signed_in? %>
                          <% unless current_user.email == "guest@example.com" %>
                            <% if current_user.following.include?(@userinfo) %>
                              <%= link_to "フォロー解除", relationship_path(current_user.active_relationships.find_by(followed_id: @userinfo)), 
                                          method: :delete,  
                                          class: "btn",
                                          style: "margin: 0px;
                                                  background: none;
                                                  font-style: inherit;
                                                  font-variant: inherit;
                                                  font-stretch: inherit;
                                                  font-family: inherit;
                                                  font-optical-sizing: inherit;
                                                  font-size-adjust: inherit;
                                                  font-kerning: inherit;
                                                  font-feature-settings: inherit;
                                                  font-variation-settings: inherit;
                                                  font-size: 14px;
                                                  line-height: 18px;
                                                  display: inline-flex;
                                                  -webkit-box-pack: center;
                                                  justify-content: center;
                                                  -webkit-box-align: center;
                                                  align-items: center;
                                                  height: 40px;
                                                  border-radius: 4px;
                                                  padding: 0px 16px;
                                                  font-weight: 400;
                                                  box-sizing: border-box;
                                                  text-align: center;
                                                  color: rgb(47, 52, 56);
                                                  border: 1px solid rgb(230, 230, 230);
                                                  width: 90px;"%>
                            <% else %>
                              <%= link_to "フォロー", relationships_path(followed_id: @userinfo), 
                                          method: :post, 
                                          class: "btn",
                                          style: "margin: 0px;
                                                  border: none;
                                                  background: none rgb(10, 165, 255);
                                                  font-style: inherit;
                                                  font-variant: inherit;
                                                  font-stretch: inherit;
                                                  font-family: inherit;
                                                  font-optical-sizing: inherit;
                                                  font-size-adjust: inherit;
                                                  font-kerning: inherit;
                                                  font-feature-settings: inherit;
                                                  font-variation-settings: inherit;
                                                  font-size: 14px;
                                                  line-height: 18px;
                                                  display: inline-flex;
                                                  -webkit-box-pack: center;
                                                  justify-content: center;
                                                  -webkit-box-align: center;
                                                  align-items: center;
                                                  height: 40px;
                                                  border-radius: 4px;
                                                  padding: 0px 16px;
                                                  box-sizing: border-box;
                                                  text-align: center;
                                                  color: rgb(255, 255, 255);
                                                  font-weight: 700;
                                                  width: 80px;"%>
                            <% end %>
                          <% end %>
                        <% end %>
                      </div>
                    <% end %>
                  </div>
                </div>
            </div>


            <div style="margin: 24px 0px;
                text-align: center;     color: rgb(66, 66, 66);
                font-size: 15px;
                line-height: 1.4;
                font-weight: 400;
                word-break: break-word;"><!-- 自己紹介～SNS -->
              <p class="mb-1">
                <%= @userinfo.introduction.presence %>
              </p>
              <% if @userinfo.sns_link.present? %>
                <% url = @userinfo.sns_link =~ /\Ahttp(s)?:\/\// ? @userinfo.sns_link : "http://#{@userinfo.sns_link}" %>
                <% display_text = url.sub(/\Ahttps?:\/\//, "") %>
                <p style="margin: 2px 0px 0px;
                          color: rgb(23, 120, 186);
                          transition: opacity 0.1s; padding: 0px">
                  <%= link_to display_text, url, target: "_blank", rel: "noopener noreferrer" %>
                </p>
              <% end %>
            </div>

            <% if current_user == @userinfo %>
              <div style="padding: 24px 0px 6px; border-top: 1px solid rgb(234, 235, 239);"><!-- ブックマーク、いいね -->
              <div class="d-flex justify-content-center" ">
              <%= link_to collections_user_path(@userinfo),
                          class: "btn d-flex flex-column align-items-center justify-content-center p-0",
                          style: "width: 90px; height: 80px; font-size: 13px; color: #292929;" do %>
                <i class="fa-regular fa-bookmark" style="font-size: 20px;"></i>
                <small class="mt-1">ブックマーク</small>
                <small><%= @userinfo.bookmarks.where(bookmarkable_type: "CardCollection").count %></small>
              <% end %>
            
              <%= link_to likes_user_path(@userinfo),
                          class: "btn d-flex flex-column align-items-center justify-content-center p-0",
                          style: "width: 90px; height: 80px; font-size: 13px; color: #292929;" do %>
                <i class="fa-regular fa-heart" style="font-size: 20px;"></i>
                <small class="mt-1">いいね</small>
                <small><%= Like.where(user_id: @userinfo.id, likeable_type: "CardCollection").count %></small>
              <% end %>
            </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div style="width: 8.333333333333332%; padding-left: 10px; padding-right: 10px;position: relative; padding-top: 30px;"><!-- 中間スペースパート -->
  </div>

  <div style="width: 66.66666666666666%; padding-left: 10px; padding-right: 10px;position: relative;"><!-- 사진,좋아요,북マーク파트 -->
    <div style="max-width: 720px; margin: 0 auto 40px; padding: 0;">
      
      <div style="padding: 0px 10px">

        <div style="margin: 40px auto 60px; width: 100%; max-width: 600px;">
          <h1 style="margin: 0 0 30px;
                      font-size: 18px;
                      line-height: 24px;
                      font-weight: bold;
                      color: #2f3438;">
            フォロワー
          </h1>
          
          <% @followers.each do |follower| %>
            <div class="d-flex justify-content-between">

              <!-- 왼쪽: 프로필 이미지 -->
              <div class="d-flex">
                <div class="p-2">
                  <%= link_to user_path(follower) do %>
                    <%= image_tag url_for(follower.get_profile_image),
                                  alt: "プロフィール画像",
                                  class: "rounded-circle",
                                  style: "width: 40px; height: 40px; object-fit: cover;" %>
                  <% end %>
                </div>
                <!-- 오른쪽: 닉네ーム, 팔로우 버튼, 자기소개 -->
                <div class="p-2">
                  <div class="d-flex align-items-center">
                    <%= link_to user_path(follower) do %>
                      <h6 class="mb-0 d-inline" style="font-size: 15px;"><%= follower.nickname %></h6>
                    <% end %>
                    <%# 현재 사용자와 표시 대상이 같지 않을 때만 팔로우/언팔로우 버튼 표시 %>

                  </div>

                  <div style="font-size: 12px;">
                    <% if follower.introduction.present? %>
                      <%= follower.introduction %>
                    <% else %>
                      作成された自己紹介はありません
                    <% end %>
                  </div>
                </div>
              </div>

              <% unless current_user == follower %>
                <div class="ms-auto" style="display: flex; align-items: center;">
                
                  <% if current_user.following.include?(follower) %>
                    <%= link_to "フォロー中", relationship_path(current_user.active_relationships.find_by(followed_id: follower.id)),
                                method: :delete,
                                data: { confirm: "本当にフォロー解除しますか？" },
                                class: "btn",
                                style: "margin: 0px;
                                        background: none;
                                        font-style: inherit;
                                        font-variant: inherit;
                                        font-stretch: inherit;
                                        font-family: inherit;
                                        font-optical-sizing: inherit;
                                        font-size-adjust: inherit;
                                        font-kerning: inherit;
                                        font-feature-settings: inherit;
                                        font-variation-settings: inherit;
                                        font-size: 14px;
                                        line-height: 18px;
                                        display: inline-flex;
                                        -webkit-box-pack: center;
                                        justify-content: center;
                                        -webkit-box-align: center;
                                        align-items: center;
                                        height: 40px;
                                        border-radius: 4px;
                                        padding: 0px 16px;
                                        font-weight: 400;
                                        box-sizing: border-box;
                                        text-align: center;
                                        color: rgb(47, 52, 56);
                                        border: 1px solid rgb(230, 230, 230);
                                        width: 100px;"%>
                  <% else %>
                    <%= link_to "フォロー", relationships_path(followed_id: follower.id),
                                method: :post,
                                      class: "btn",
                                      style: "margin: 0px;
                                              border: none;
                                              background: none rgb(10, 165, 255);
                                              font-style: inherit;
                                              font-variant: inherit;
                                              font-stretch: inherit;
                                              font-family: inherit;
                                              font-optical-sizing: inherit;
                                              font-size-adjust: inherit;
                                              font-kerning: inherit;
                                              font-feature-settings: inherit;
                                              font-variation-settings: inherit;
                                              font-size: 14px;
                                              line-height: 18px;
                                              display: inline-flex;
                                              -webkit-box-pack: center;
                                              justify-content: center;
                                              -webkit-box-align: center;
                                              align-items: center;
                                              height: 40px;
                                              border-radius: 4px;
                                              padding: 0px 16px;
                                              box-sizing: border-box;
                                              text-align: center;
                                              color: rgb(255, 255, 255);
                                              font-weight: 700;
                                              width: 100px;"%>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>

      </div>
      
    </div>
  </div>
</div>

<div class="d-none d-md-block d-lg-none" style="margin:0 -10px; padding:0; box-sizing:border-box;">


  <div style="width: 100%; padding-left: 10px; padding-right: 10px;position: relative; padding-top: 30px;"><!-- 카드파트 -->
    <div style="position: relative;">
      <div>
        <div style= "padding: 30px 25px 18px;
              border-radius: 4px;
              border: 1px solid rgb(218, 220, 224);
              box-shadow: rgba(63, 71, 77, 0.06); position: relative;">

          <div class="d-flex justify-content-between" style=" padding: 0px;min-height: 120px; position: relative; margin: 0px 0px 50px"><!-- プロフィール～設定 -->
            <div class="d-flex">
              <div style="position: relative; overflow: hidden;">
                <%= image_tag url_for(@userinfo.get_profile_image), alt: "プロフィール画像", class: "rounded-circle", style: "width: 120px; height: 120px; object-fit: cover; border: 1px solid rgba(0, 0, 0, 0.1);" %>
              </div>

              <div class="pt-2" style="text-align: center; margin-left: 20px"><!-- その他 -->
                <div style="line-height: 1.15;         margin: 0px 0px 10px;
                              font-size: 22px; font-weight: bold;     color: rgb(41, 41, 41);
                          overflow-wrap: break-word;
                          word-break: break-all;
                      }">
                  <%= @userinfo.nickname %>
                </div>

                <div style="text-align: center;">
                  <div class="d-flex justify-content-center align-items-center mb-3 flex-nowrap text-nowrap text-secondary" style="font-size:12px; line-height:1.4;">
                    <div class="me-3" style="margin-right:5px;">
                      <span class="me-1" style="margin-right: 3px">フォロワー</span>
                      <%= link_to @userinfo.followers.count, follower_user_path(@userinfo),
                                  class: "fw-bold text-dark text-decoration-none" %>
                    </div>
                    <div style="padding-left: 5px; border-left: 1px solid black">
                      <span class="me-1" style="margin-right: 3px">フォロー中</span>
                      <%= link_to @userinfo.following.count, followee_user_path(@userinfo),
                                  class: "fw-bold text-dark text-decoration-none" %>
                    </div>
                  </div>
                </div>

                <div style="margin: 5px 0px;
                    text-align: start;     color: rgb(66, 66, 66);
                    font-size: 15px;
                    line-height: 1.4;
                    font-weight: 400;
                    word-break: break-word;"><!-- 自己紹介～SNS -->
                  <p class="mb-1">
                    <%= @userinfo.introduction.presence %>
                  </p>
                  <% if @userinfo.sns_link.present? %>
                    <% url = @userinfo.sns_link =~ /\Ahttp(s)?:\/\// ? @userinfo.sns_link : "http://#{@userinfo.sns_link}" %>
                    <% display_text = url.sub(/\Ahttps?:\/\//, "") %>
                    <p style="margin: 2px 0px 0px;
                              color: rgb(23, 120, 186);
                              transition: opacity 0.1s; padding: 0px">
                      <%= link_to display_text, url, target: "_blank", rel: "noopener noreferrer" %>
                    </p>
                  <% end %>
                </div>
              </div>
            </div>

            <% if current_user == @userinfo%>
              <div><!-- 設定ボタン -->
                <%= link_to "設定", edit_user_path(current_user), class: "btn",
                style: "margin: 0px;
                        background: none;
                        font-style: inherit;
                        font-variant: inherit;
                        font-stretch: inherit;
                        font-family: inherit;
                        font-optical-sizing: inherit;
                        font-size-adjust: inherit;
                        font-kerning: inherit;
                        font-feature-settings: inherit;
                        font-variation-settings: inherit;
                        font-size: 18px;
                        line-height: 18px;
                        display: inline-flex;
                        -webkit-box-pack: center;
                        justify-content: center;
                        -webkit-box-align: center;
                        align-items: center;
                        height: 33px;
                        border-radius: 4px;
                        padding: 20px 16px;
                        font-weight: 500;
                        box-sizing: border-box;
                        text-align: center;
                        color: rgb(47, 52, 56);
                        border: 1px solid rgb(230, 230, 230);
                        width: 100px;"%>
              </div>
            <% else %>
              <div class="ms-auto">
                <% if user_signed_in? %>
                  <% unless current_user.email == "guest@example.com" %>
                    <% if current_user.following.include?(@userinfo) %>
                      <%= link_to "フォロー解除", relationship_path(current_user.active_relationships.find_by(followed_id: @userinfo)), 
                                  method: :delete,  
                                  class: "btn",
                                  style: "margin: 0px;
                                          background: none;
                                          font-style: inherit;
                                          font-variant: inherit;
                                          font-stretch: inherit;
                                          font-family: inherit;
                                          font-optical-sizing: inherit;
                                          font-size-adjust: inherit;
                                          font-kerning: inherit;
                                          font-feature-settings: inherit;
                                          font-variation-settings: inherit;
                                          font-size: 14px;
                                          line-height: 18px;
                                          display: inline-flex;
                                          -webkit-box-pack: center;
                                          justify-content: center;
                                          -webkit-box-align: center;
                                          align-items: center;
                                          height: 40px;
                                          border-radius: 4px;
                                          padding: 0px 16px;
                                          font-weight: 400;
                                          box-sizing: border-box;
                                          text-align: center;
                                          color: rgb(47, 52, 56);
                                          border: 1px solid rgb(230, 230, 230);
                                          width: 90px;"%>
                    <% else %>
                      <%= link_to "フォロー", relationships_path(followed_id: @userinfo), 
                                  method: :post, 
                                  class: "btn",
                                  style: "margin: 0px;
                                          border: none;
                                          background: none rgb(10, 165, 255);
                                          font-style: inherit;
                                          font-variant: inherit;
                                          font-stretch: inherit;
                                          font-family: inherit;
                                          font-optical-sizing: inherit;
                                          font-size-adjust: inherit;
                                          font-kerning: inherit;
                                          font-feature-settings: inherit;
                                          font-variation-settings: inherit;
                                          font-size: 14px;
                                          line-height: 18px;
                                          display: inline-flex;
                                          -webkit-box-pack: center;
                                          justify-content: center;
                                          -webkit-box-align: center;
                                          align-items: center;
                                          height: 40px;
                                          border-radius: 4px;
                                          padding: 0px 16px;
                                          box-sizing: border-box;
                                          text-align: center;
                                          color: rgb(255, 255, 255);
                                          font-weight: 700;
                                          width: 80px;"%>
                    <% end %>
                  <% end %>
                <% end %>
              </div>
            <% end %>
            
          </div>




          <% if current_user == @userinfo %>
            <div style="padding: 24px 0px 6px; border-top: 1px solid rgb(234, 235, 239);"><!-- ブックマーク、いいね -->
              <div class="d-flex justify-content-around">
                <%= link_to collections_user_path(@userinfo),
                            class: "btn d-flex flex-column align-items-center justify-content-center p-0",
                            style: "width: 90px; height: 80px; font-size: 13px; color: #292929; margin-left:30px;" do %>
                  <i class="fa-regular fa-bookmark" style="font-size: 23px;"></i>
                  <small class="mt-1">ブックマーク</small>
                  <small><%= @userinfo.bookmarks.where(bookmarkable_type: "CardCollection").count %></small>
                <% end %>
              
                <%= link_to likes_user_path(@userinfo),
                            class: "btn d-flex flex-column align-items-center justify-content-center p-0",
                            style: "width: 90px; height: 80px; font-size: 15px; color: #292929; margin-right:30px;" do %>
                  <i class="fa-regular fa-heart" style="font-size: 23px;"></i>
                  <small class="mt-1">いいね</small>
                  <small><%= Like.where(user_id: @userinfo.id, likeable_type: "CardCollection").count %></small>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div style="width: 100%; padding-left: 10px; padding-right: 10px;position: relative; padding-top: 30px;"><!-- 中間スペースパート -->
  </div>

  <div style="width: 100%; padding-left: 10px; padding-right: 10px;position: relative;"><!-- 사진,좋아요,북マーク파트 -->
    <div style="max-width: 720px; margin: 0 auto 40px; padding: 0;">
      
      <div style="padding: 0px 10px">

        <div style="margin: 40px auto 60px; width: 100%; max-width: 600px;">
          <h1 style="margin: 0 0 30px;
                      font-size: 18px;
                      line-height: 24px;
                      font-weight: bold;
                      color: #2f3438;">
            フォロワー
          </h1>
          
          <% @followers.each do |follower| %>
            <div class="d-flex justify-content-between">

              <!-- 왼쪽: 프로필 이미지 -->
              <div class="d-flex">
                <div class="p-2">
                  <%= link_to user_path(follower) do %>
                    <%= image_tag url_for(follower.get_profile_image),
                                  alt: "プロフィール画像",
                                  class: "rounded-circle",
                                  style: "width: 40px; height: 40px; object-fit: cover;" %>
                  <% end %>
                </div>
                <!-- 오른쪽: 닉네ーム, 팔로우 버튼, 자기소개 -->
                <div class="p-2">
                  <div class="d-flex align-items-center">
                    <%= link_to user_path(follower) do %>
                      <h6 class="mb-0 d-inline" style="font-size: 15px;"><%= follower.nickname %></h6>
                    <% end %>
                    <%# 현재 사용자와 표시 대상이 같지 않을 때만 팔로우/언팔로우 버튼 표시 %>

                  </div>

                  <div style="font-size: 12px;">
                    <% if follower.introduction.present? %>
                      <%= follower.introduction %>
                    <% else %>
                      作成された自己紹介はありません
                    <% end %>
                  </div>
                </div>
              </div>

              <% unless current_user == follower %>
                <div class="ms-auto" style="display: flex; align-items: center;">
                
                  <% if current_user.following.include?(follower) %>
                    <%= link_to "フォロー中", relationship_path(current_user.active_relationships.find_by(followed_id: follower.id)),
                                method: :delete,
                                data: { confirm: "本当にフォロー解除しますか？" },
                                class: "btn",
                                style: "margin: 0px;
                                        background: none;
                                        font-style: inherit;
                                        font-variant: inherit;
                                        font-stretch: inherit;
                                        font-family: inherit;
                                        font-optical-sizing: inherit;
                                        font-size-adjust: inherit;
                                        font-kerning: inherit;
                                        font-feature-settings: inherit;
                                        font-variation-settings: inherit;
                                        font-size: 14px;
                                        line-height: 18px;
                                        display: inline-flex;
                                        -webkit-box-pack: center;
                                        justify-content: center;
                                        -webkit-box-align: center;
                                        align-items: center;
                                        height: 40px;
                                        border-radius: 4px;
                                        padding: 0px 16px;
                                        font-weight: 400;
                                        box-sizing: border-box;
                                        text-align: center;
                                        color: rgb(47, 52, 56);
                                        border: 1px solid rgb(230, 230, 230);
                                        width: 100px;"%>
                  <% else %>
                    <%= link_to "フォロー", relationships_path(followed_id: follower.id),
                                method: :post,
                                      class: "btn",
                                      style: "margin: 0px;
                                              border: none;
                                              background: none rgb(10, 165, 255);
                                              font-style: inherit;
                                              font-variant: inherit;
                                              font-stretch: inherit;
                                              font-family: inherit;
                                              font-optical-sizing: inherit;
                                              font-size-adjust: inherit;
                                              font-kerning: inherit;
                                              font-feature-settings: inherit;
                                              font-variation-settings: inherit;
                                              font-size: 14px;
                                              line-height: 18px;
                                              display: inline-flex;
                                              -webkit-box-pack: center;
                                              justify-content: center;
                                              -webkit-box-align: center;
                                              align-items: center;
                                              height: 40px;
                                              border-radius: 4px;
                                              padding: 0px 16px;
                                              box-sizing: border-box;
                                              text-align: center;
                                              color: rgb(255, 255, 255);
                                              font-weight: 700;
                                              width: 100px;"%>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>

      </div>
      
    </div>
  </div>

</div>

<div class="d-md-none" style="margin:0 -10px; padding:0; box-sizing:border-box;">


  <div style="width: 100%; padding-left: 10px; padding-right: 10px;position: relative; padding-top: 30px;"><!-- 카드파트 -->
    <div style="position: relative;">
      <div>
        <div style= "padding-top: 10px;
              border-radius: 4px;
              border: 1px solid rgb(218, 220, 224);
              box-shadow: rgba(63, 71, 77, 0.06); position: relative;">

          <div style=" padding: 0px;min-height: 120px; position: relative; margin: 0px 0px 20px"><!-- プロフィール～設定 -->
            
              <div style="text-align: center; position: relative; overflow: hidden;">
                <%= image_tag url_for(@userinfo.get_profile_image), alt: "プロフィール画像", class: "rounded-circle", style: "width: 100px; height: 100px; object-fit: cover; border: 1px solid rgba(0, 0, 0, 0.1);" %>
              </div>

              <div class="pt-2" style="text-align: center;"><!-- その他 -->
                <div style="line-height: 1.15; margin: 0px 0px 3px;
                              font-size: 18px; font-weight: bold;     color: rgb(41, 41, 41);
                          overflow-wrap: break-word;
                          word-break: break-all;
                      }">
                  <%= @userinfo.nickname %>
                </div>

                <div style="text-align: center;">
                  <div class="d-flex justify-content-center align-items-center flex-nowrap text-nowrap text-secondary" style="font-size:12px; line-height:1.4;">
                    <div class="me-3" style="margin-right:5px;">
                      <span class="me-1" style="margin-right: 3px">フォロワー</span>
                      <%= link_to @userinfo.followers.count, follower_user_path(@userinfo),
                                  class: "fw-bold text-dark text-decoration-none" %>
                    </div>
                    <div style="padding-left: 5px; border-left: 1px solid black">
                      <span class="me-1" style="margin-right: 3px">フォロー中</span>
                      <%= link_to @userinfo.following.count, followee_user_path(@userinfo),
                                  class: "fw-bold text-dark text-decoration-none" %>
                    </div>
                  </div>
                </div>

                <div style="margin: 5px 0px;
                    text-align: center;     color: rgb(66, 66, 66);
                    font-size: 13px;
                    line-height: 1.4;
                    font-weight: 400;
                    word-break: break-word;"><!-- 自己紹介～SNS -->
                  <p class="mb-1">
                    <%= @userinfo.introduction.presence %>
                  </p>
                  <% if @userinfo.sns_link.present? %>
                    <% url = @userinfo.sns_link =~ /\Ahttp(s)?:\/\// ? @userinfo.sns_link : "http://#{@userinfo.sns_link}" %>
                    <% display_text = url.sub(/\Ahttps?:\/\//, "") %>
                    <p style="margin: 2px 0px 0px;
                              color: rgb(23, 120, 186);
                              transition: opacity 0.1s; padding: 0px">
                      <%= link_to display_text, url, target: "_blank", rel: "noopener noreferrer" %>
                    </p>
                  <% end %>
                </div>
              </div>
            

            <% if current_user == @userinfo%>
              <div class="pt-2" style="text-align: center;"><!-- 設定ボタン -->
                <%= link_to "設定", edit_user_path(current_user), class: "btn",
                style: "margin: 0px;
                        background: none;
                        font-style: inherit;
                        font-variant: inherit;
                        font-stretch: inherit;
                        font-family: inherit;
                        font-optical-sizing: inherit;
                        font-size-adjust: inherit;
                        font-kerning: inherit;
                        font-feature-settings: inherit;
                        font-variation-settings: inherit;
                        font-size: 18px;
                        line-height: 18px;
                        display: inline-flex;
                        -webkit-box-pack: center;
                        justify-content: center;
                        -webkit-box-align: center;
                        align-items: center;
                        height: 33px;
                        border-radius: 4px;
                        padding: 20px 16px;
                        font-weight: 500;
                        box-sizing: border-box;
                        text-align: center;
                        color: rgb(47, 52, 56);
                        border: 1px solid rgb(230, 230, 230);
                        width: 100px;"%>
              </div>
            <% else %>
              <div style="
                  display: flex;
                  justify-content: center;  /* ← 横方向中央寄せ */
                  align-items: center;
                  width: 100%;              /* ← 親要素を行いっぱいに */
                  padding-top: 8px;         /* ← 必要に応じて余白調整 */
                ">
                <% if user_signed_in? %>
                  <% unless current_user.email == "guest@example.com" %>
                    <% if current_user.following.include?(@userinfo) %>
                      <%= link_to "フォロー解除", relationship_path(current_user.active_relationships.find_by(followed_id: @userinfo)), 
                                  method: :delete,  
                                  class: "btn",
                                  style: "margin: 0px;
                                          background: none;
                                          font-style: inherit;
                                          font-variant: inherit;
                                          font-stretch: inherit;
                                          font-family: inherit;
                                          font-optical-sizing: inherit;
                                          font-size-adjust: inherit;
                                          font-kerning: inherit;
                                          font-feature-settings: inherit;
                                          font-variation-settings: inherit;
                                          font-size: 14px;
                                          line-height: 18px;
                                          display: inline-flex;
                                          -webkit-box-pack: center;
                                          justify-content: center;
                                          -webkit-box-align: center;
                                          align-items: center;
                                          height: 40px;
                                          border-radius: 4px;
                                          padding: 0px 16px;
                                          font-weight: 400;
                                          box-sizing: border-box;
                                          text-align: center;
                                          color: rgb(47, 52, 56);
                                          border: 1px solid rgb(230, 230, 230);
                                          width: 90px;"%>
                    <% else %>
                      <%= link_to "フォロー", relationships_path(followed_id: @userinfo), 
                                  method: :post, 
                                  class: "btn",
                                  style: "margin: 0px;
                                          border: none;
                                          background: none rgb(10, 165, 255);
                                          font-style: inherit;
                                          font-variant: inherit;
                                          font-stretch: inherit;
                                          font-family: inherit;
                                          font-optical-sizing: inherit;
                                          font-size-adjust: inherit;
                                          font-kerning: inherit;
                                          font-feature-settings: inherit;
                                          font-variation-settings: inherit;
                                          font-size: 14px;
                                          line-height: 18px;
                                          display: inline-flex;
                                          -webkit-box-pack: center;
                                          justify-content: center;
                                          -webkit-box-align: center;
                                          align-items: center;
                                          height: 40px;
                                          border-radius: 4px;
                                          padding: 0px 16px;
                                          box-sizing: border-box;
                                          text-align: center;
                                          color: rgb(255, 255, 255);
                                          font-weight: 700;
                                          width: 80px;"%>
                    <% end %>
                  <% end %>
                <% end %>
              </div>
            <% end %>
            
          </div>




          <% if current_user == @userinfo %>
            <div style="padding: 10px 0px 6px; border-top: 1px solid rgb(234, 235, 239);"><!-- ブックマーク、いいね -->
              <div class="d-flex justify-content-around">
                <%= link_to collections_user_path(@userinfo),
                            class: "btn d-flex flex-column align-items-center justify-content-center p-0",
                            style: "width: 90px; height: 80px; font-size: 13px; color: #292929; margin-left:30px;" do %>
                  <i class="fa-regular fa-bookmark" style="font-size: 23px;"></i>
                  <small class="mt-1">ブックマーク</small>
                  <small><%= @userinfo.bookmarks.where(bookmarkable_type: "CardCollection").count %></small>
                <% end %>
              
                <%= link_to likes_user_path(@userinfo),
                            class: "btn d-flex flex-column align-items-center justify-content-center p-0",
                            style: "width: 90px; height: 80px; font-size: 15px; color: #292929; margin-right:30px;" do %>
                  <i class="fa-regular fa-heart" style="font-size: 23px;"></i>
                  <small class="mt-1">いいね</small>
                  <small><%= Like.where(user_id: @userinfo.id, likeable_type: "CardCollection").count %></small>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <div style="width: 100%; padding-left: 10px; padding-right: 10px;position: relative; padding-top: 30px;"><!-- 中間スペースパート -->
  </div>

  <div style="width: 100%; padding-left: 10px; padding-right: 10px;position: relative;"><!-- 사진,좋아요,북マーク파트 -->
    <div style="max-width: 720px; margin: 0 auto 40px; padding: 0;">
      
      <div style="padding: 0px 10px">

        <div style="margin: 40px auto 60px; width: 100%; max-width: 600px;">
          <h1 style="margin: 0 0 30px;
                      font-size: 18px;
                      line-height: 24px;
                      font-weight: bold;
                      color: #2f3438;">
            フォロワー
          </h1>
          
          <% @followers.each do |follower| %>
            <div class="d-flex justify-content-between">

              <!-- 왼쪽: 프로필 이미지 -->
              <div class="d-flex">
                <div class="p-2">
                  <%= link_to user_path(follower) do %>
                    <%= image_tag url_for(follower.get_profile_image),
                                  alt: "プロフィール画像",
                                  class: "rounded-circle",
                                  style: "width: 40px; height: 40px; object-fit: cover;" %>
                  <% end %>
                </div>
                <!-- 오른쪽: 닉네ーム, 팔로우 버튼, 자기소개 -->
                <div class="p-2">
                  <div class="d-flex align-items-center">
                    <%= link_to user_path(follower) do %>
                      <h6 class="mb-0 d-inline" style="font-size: 15px;"><%= follower.nickname %></h6>
                    <% end %>
                    <%# 현재 사용자와 표시 대상이 같지 않을 때만 팔로우/언팔로우 버튼 표시 %>

                  </div>

                  <div style="font-size: 12px;">
                    <% if follower.introduction.present? %>
                      <%= follower.introduction %>
                    <% else %>
                      作成された自己紹介はありません
                    <% end %>
                  </div>
                </div>
              </div>

              <% unless current_user == follower %>
                <div class="ms-auto" style="display: flex; align-items: center;">
                
                  <% if current_user.following.include?(follower) %>
                    <%= link_to "フォロー中", relationship_path(current_user.active_relationships.find_by(followed_id: follower.id)),
                                method: :delete,
                                data: { confirm: "本当にフォロー解除しますか？" },
                                class: "btn",
                                style: "margin: 0px;
                                        background: none;
                                        font-style: inherit;
                                        font-variant: inherit;
                                        font-stretch: inherit;
                                        font-family: inherit;
                                        font-optical-sizing: inherit;
                                        font-size-adjust: inherit;
                                        font-kerning: inherit;
                                        font-feature-settings: inherit;
                                        font-variation-settings: inherit;
                                        font-size: 14px;
                                        line-height: 18px;
                                        display: inline-flex;
                                        -webkit-box-pack: center;
                                        justify-content: center;
                                        -webkit-box-align: center;
                                        align-items: center;
                                        height: 40px;
                                        border-radius: 4px;
                                        padding: 0px 16px;
                                        font-weight: 400;
                                        box-sizing: border-box;
                                        text-align: center;
                                        color: rgb(47, 52, 56);
                                        border: 1px solid rgb(230, 230, 230);
                                        width: 100px;"%>
                  <% else %>
                    <%= link_to "フォロー", relationships_path(followed_id: follower.id),
                                method: :post,
                                      class: "btn",
                                      style: "margin: 0px;
                                              border: none;
                                              background: none rgb(10, 165, 255);
                                              font-style: inherit;
                                              font-variant: inherit;
                                              font-stretch: inherit;
                                              font-family: inherit;
                                              font-optical-sizing: inherit;
                                              font-size-adjust: inherit;
                                              font-kerning: inherit;
                                              font-feature-settings: inherit;
                                              font-variation-settings: inherit;
                                              font-size: 14px;
                                              line-height: 18px;
                                              display: inline-flex;
                                              -webkit-box-pack: center;
                                              justify-content: center;
                                              -webkit-box-align: center;
                                              align-items: center;
                                              height: 40px;
                                              border-radius: 4px;
                                              padding: 0px 16px;
                                              box-sizing: border-box;
                                              text-align: center;
                                              color: rgb(255, 255, 255);
                                              font-weight: 700;
                                              width: 100px;"%>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% end %>
        </div>

      </div>
      
    </div>
  </div>
</div>